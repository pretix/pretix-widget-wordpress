{"version":3,"file":"pretix-widget.build.js","mappings":"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","sources":["webpack://pretix-widget/./src/blocks/pretix-widget/components/server_side_renderer/index.js","webpack://pretix-widget/./src/blocks/pretix-widget/edit.js","webpack://pretix-widget/./src/blocks/pretix-widget/index.js","webpack://pretix-widget/./src/blocks/pretix-widget/save.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nconst { useDebounce, usePrevious } = wp.compose;\nconst { RawHTML, useEffect, useRef, useState } = wp.element;\nconst { __, sprintf } = wp.i18n;\nconst apiFetch = wp.apiFetch;\nconst { addQueryArgs } = wp.url;\nconst { Placeholder, Spinner } = wp.components;\nconst { __experimentalSanitizeBlockAttributes } = wp.blocks;\n\nexport function rendererPath( block, attributes = null, urlQueryArgs = {} ) {\n\treturn addQueryArgs( `/wp/v2/block-renderer/${ block }`, {\n\t\tcontext: 'edit',\n\t\t...( null !== attributes ? { attributes } : {} ),\n\t\t...urlQueryArgs,\n\t} );\n}\n\nfunction DefaultEmptyResponsePlaceholder( { className } ) {\n\treturn (\n\t\t<Placeholder className={ className }>\n\t\t\t{ __( 'Block rendered as empty.' ) }\n\t\t</Placeholder>\n\t);\n}\n\nfunction DefaultErrorResponsePlaceholder( { response, className } ) {\n\tconst errorMessage = sprintf(\n\t\t// translators: %s: error message describing the problem\n\t\t__( 'Error loading block: %s' ),\n\t\tresponse.errorMsg\n\t);\n\treturn <Placeholder className={ className }>{ errorMessage }</Placeholder>;\n}\n\nfunction DefaultLoadingResponsePlaceholder( { children, showLoader } ) {\n\treturn (\n\t\t<div style={ { position: 'relative' } }>\n\t\t\t{ showLoader && (\n\t\t\t\t<div\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: '50%',\n\t\t\t\t\t\tleft: '50%',\n\t\t\t\t\t\tmarginTop: '-9px',\n\t\t\t\t\t\tmarginLeft: '-9px',\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t<Spinner />\n\t\t\t\t</div>\n\t\t\t) }\n\t\t\t<div style={ { opacity: showLoader ? '0.3' : 1 } }>\n\t\t\t\t{ children }\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default function ServerSideRender( props ) {\n\tconst {\n\t\tattributes,\n\t\tblock,\n\t\tclassName,\n\t\thttpMethod = 'GET',\n\t\turlQueryArgs,\n\t\tEmptyResponsePlaceholder = DefaultEmptyResponsePlaceholder,\n\t\tErrorResponsePlaceholder = DefaultErrorResponsePlaceholder,\n\t\tLoadingResponsePlaceholder = DefaultLoadingResponsePlaceholder,\n\t} = props;\n\t\n\tconst isMountedRef = useRef( true );\n\tconst [ showLoader, setShowLoader ] = useState( false );\n\tconst fetchRequestRef = useRef();\n\tconst [ response, setResponse ] = useState( null );\n\tconst prevProps = usePrevious( props );\n\tconst [ isLoading, setIsLoading ] = useState( false );\n\t\n\tfunction fetchData() {\n\t\tif ( ! isMountedRef.current ) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tsetIsLoading( true );\n\t\t\n\t\tconst sanitizedAttributes =\n\t\t\tattributes &&\n\t\t\t__experimentalSanitizeBlockAttributes( block, attributes );\n\t\t\n\t\t// If httpMethod is 'POST', send the attributes in the request body instead of the URL.\n\t\t// This allows sending a larger attributes object than in a GET request, where the attributes are in the URL.\n\t\tconst isPostRequest = 'POST' === httpMethod;\n\t\tconst urlAttributes = isPostRequest\n\t\t\t? null\n\t\t\t: sanitizedAttributes ?? null;\n\t\tconst path = rendererPath( block, urlAttributes, urlQueryArgs );\n\t\tconst data = isPostRequest\n\t\t\t? { attributes: sanitizedAttributes ?? null }\n\t\t\t: null;\n\t\t\n\t\t// Store the latest fetch request so that when we process it, we can\n\t\t// check if it is the current request, to avoid race conditions on slow networks.\n\t\tconst fetchRequest = ( fetchRequestRef.current = apiFetch( {\n\t\t\tpath,\n\t\t\tdata,\n\t\t\tmethod: isPostRequest ? 'POST' : 'GET',\n\t\t} )\n\t\t\t.then( ( fetchResponse ) => {\n\t\t\t\tif (\n\t\t\t\t\tisMountedRef.current &&\n\t\t\t\t\tfetchRequest === fetchRequestRef.current &&\n\t\t\t\t\tfetchResponse\n\t\t\t\t) {\n\t\t\t\t\tsetResponse( fetchResponse.rendered );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( ( error ) => {\n\t\t\t\tif (\n\t\t\t\t\tisMountedRef.current &&\n\t\t\t\t\tfetchRequest === fetchRequestRef.current\n\t\t\t\t) {\n\t\t\t\t\tsetResponse( {\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMsg: error.message,\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.finally( () => {\n\t\t\t\tif (\n\t\t\t\t\tisMountedRef.current &&\n\t\t\t\t\tfetchRequest === fetchRequestRef.current\n\t\t\t\t) {\n\t\t\t\t\tsetIsLoading( false );\n\t\t\t\t}\n\t\t\t} ) );\n\t\t\n\t\treturn fetchRequest;\n\t}\n\t\n\tconst debouncedFetchData = useDebounce( fetchData, 500 );\n\t\n\t// When the component unmounts, set isMountedRef to false. This will\n\t// let the async fetch callbacks know when to stop.\n\tuseEffect(\n\t\t() => () => {\n\t\t\tisMountedRef.current = false;\n\t\t},\n\t\t[]\n\t);\n\t\n\tuseEffect( () => {\n\t\t// Don't debounce the first fetch. This ensures that the first render\n\t\t// shows data as soon as possible.\n\t\tif ( prevProps === undefined ) {\n\t\t\tfetchData();\n\t\t} else if ( JSON.stringify(prevProps) !== JSON.stringify(props) ) {\n\t\t\tdebouncedFetchData();\n\t\t}\n\t} );\n\t\n\t/**\n\t * Effect to handle showing the loading placeholder.\n\t * Show it only if there is no previous response or\n\t * the request takes more than one second.\n\t */\n\tuseEffect( () => {\n\t\tif ( ! isLoading ) {\n\t\t\treturn;\n\t\t}\n\t\tconst timeout = setTimeout( () => {\n\t\t\tsetShowLoader( true );\n\t\t}, 2000 );\n\t\treturn () => clearTimeout( timeout );\n\t}, [ isLoading ] );\n\t\n\tconst hasResponse = !! response;\n\tconst hasEmptyResponse = response === '';\n\tconst hasError = response?.error;\n\t\n\tif ( isLoading ) {\n\t\treturn (\n\t\t\t<LoadingResponsePlaceholder { ...props } showLoader={ showLoader }>\n\t\t\t\t{ hasResponse && (\n\t\t\t\t\t<RawHTML className={ className }>{ response }</RawHTML>\n\t\t\t\t) }\n\t\t\t</LoadingResponsePlaceholder>\n\t\t);\n\t}\n\t\n\tif ( hasEmptyResponse || ! hasResponse ) {\n\t\treturn <EmptyResponsePlaceholder { ...props } />;\n\t}\n\t\n\tif ( hasError ) {\n\t\treturn <ErrorResponsePlaceholder response={ response } { ...props } />;\n\t}\n\t\n\treturn <RawHTML className={ className }>{ response }</RawHTML>;\n}","/**\n * Version: 1.0.00\n */\n\n// Import WordPress dependencies\nconst { useEffect, useState } = wp.element;\nconst { __ } = wp.i18n;\nconst { TextControl, ToggleControl, SelectControl, PanelBody, Placeholder } = wp.components;\nimport ServerSideRender from './components/server_side_renderer';\n\n// Destructure WordPress block editor dependencies\nconst {\n\tuseBlockProps,\n\tInspectorControls,\n} = wp.blockEditor;\n\n// Inject defaults from PHP\nconst defaults = {};\n\nif (pretixWidgetDefaults) {\n\tfor (const key in pretixWidgetDefaults) {\n\t\tif (pretixWidgetDefaults.hasOwnProperty(key)) {\n\t\t\tdefaults[key] = pretixWidgetDefaults[key] === '' ? null : pretixWidgetDefaults[key];\n\t\t}\n\t}\n}\n\n// Inject languages from PHP or use defaults\nconst languages = pretixWidgetLanguages ? Object.values(pretixWidgetLanguages) : [\n\t{\n\t\t\"code\": \"en\",\n\t\t\"locale\": \"en_GB\",\n\t\t\"name\": \"English\",\n\t\t\"supported\": true\n\t},\n\t{\n\t\t\"code\": \"de\",\n\t\t\"locale\": \"de_DE\",\n\t\t\"name\": \"German\",\n\t\t\"supported\": true\n\t},\n];\n\n/**\n * Edit Function\n * This function defines the block editor interface and handling for the 'pretix/widget' block.\n * @param {Object} props The block properties and methods.\n * @version 1.0.00\n */\nexport default function Edit(props) {\n\tconst {\n\t\tclientId,\n\t\tattributes,\n\t\tsetAttributes,\n\t} = props;\n\t\n\t// Destructure attributes and add defaults\n\tconst {\n\t\talign,\n\t\tmode,\n\t\tsubevent,\n\t\titems,\n\t\tcategories,\n\t\tvariations,\n\t\tallocated_voucher,\n\t\t// Settings which can be overwritten by defaults from the WP settings page on first insert\n\t\tlist_type = defaults.pretix_widget_list_type ?? 'list',\n\t\tshop_url = defaults.pretix_widget_shop_url && defaults.pretix_widget_shop_url.replace(/\\s/g, '').length > 0 ? defaults.pretix_widget_shop_url : '',\n\t\tdisable_voucher = defaults.pretix_widget_disable_voucher ?? false,\n\t\tlanguage = defaults.pretix_widget_language ?? 'en',\n\t\tbutton_text = defaults.pretix_widget_button_text && defaults.pretix_widget_button_text.replace(/\\s/g, '').length > 0 ? defaults.pretix_widget_button_text : 'Buy Ticket!',\n\t} = attributes;\n\t\n\t// Use blockProps for block wrapper\n\tconst blockProps = useBlockProps();\n\tconst [loading, setLoading] = useState(false);\n\t\n\t/**\n\t * handleChange Function\n\t * Helper function to update the attribute value.\n\t * @param {string} key The key of the attribute to update.\n\t * @param {any} value The new value for the attribute.\n\t * @version 1.0.00\n\t */\n\tconst handleChange = (key, value) => {\n\t\tsetAttributes({ [key]: value });\n\t}\n\t\n\t/**\n\t * isValidUrl Function\n\t * Helper function to check if a given URL is valid.\n\t * @param {string} url The URL to check.\n\t * @returns {boolean} True if the URL is valid, false otherwise.\n\t * @version 1.0.00\n\t */\n\tconst isValidUrl = (url) => {\n\t\ttry {\n\t\t\tnew URL(url);\n\t\t\treturn true;\n\t\t} catch (err) {\n\t\t\treturn false;\n\t\t}\n\t};\n\t\n\t/**\n\t * insertScriptAssets Function\n\t * Helper function to insert the Pretix widget script assets dynamically.\n\t * @version 1.0.00\n\t */\n\tconst insertScriptAssets = () => {\n\t\tif (isValidUrl(shop_url)) {\n\t\t\tconst scriptId = 'pretix-widget-script-' + clientId;\n\t\t\tlet script = document.getElementById(scriptId);\n\t\t\tif (script) {\n\t\t\t\tdocument.body.removeChild(script);\n\t\t\t}\n\t\t\tscript = document.createElement(\"script\");\n\t\t\tscript.id = scriptId;\n\t\t\twindow.PretixWidget = null;\n\t\t\t\n\t\t\tconst url = new URL(shop_url);\n\t\t\tconst _url = url.hostname;\n\t\t\tconst filename = language.replace('_', '-');\n\t\t\tscript.src = `https://${_url}/widget/v1.${filename}.js?timestamp=${Date.now()}`;\n\t\t\tscript.async = true;\n\t\t\tscript.onload = () => {\n\t\t\t\twindow.PretixWidget.buildWidgets();\n\t\t\t};\n\t\t\tdocument.body.appendChild(script);\n\t\t}\n\t}\n\t\n\t/**\n\t * insertCSSAssets Function\n\t * Helper function to insert the Pretix widget CSS assets dynamically.\n\t * @version 1.0.00\n\t */\n\tconst insertCSSAssets = () => {\n\t\tif (isValidUrl(shop_url)) {\n\t\t\tconst linkId = 'pretix-widget-style-' + clientId;\n\t\t\tlet link = document.getElementById(linkId);\n\t\t\tif (link) {\n\t\t\t\tdocument.body.removeChild(link);\n\t\t\t}\n\t\t\tlink = document.createElement(\"link\");\n\t\t\tlink.rel = \"stylesheet\";\n\t\t\tconst url = new URL(shop_url);\n\t\t\tconst _url = url.hostname + url.pathname.replace(/\\/$/, '')\n\t\t\tlink.href = `https://${_url}/widget/v1.css?timestamp=${Date.now()}`;\n\t\t\tdocument.head.appendChild(link);\n\t\t}\n\t}\n\t\n\t/**\n\t * EmptyResponsePlaceholder Function\n\t * Placeholder component for empty responses during server-side rendering.\n\t * @returns {JSX.Element} The JSX for the empty response placeholder.\n\t * @version 1.0.00\n\t */\n\tconst EmptyResponsePlaceholder = () => <Placeholder label={'Empty'} />;\n\t\n\t/**\n\t * ErrorResponsePlaceholder Function\n\t * Placeholder component for error responses during server-side rendering.\n\t * @returns {JSX.Element} The JSX for the error response placeholder.\n\t * @version 1.0.00\n\t */\n\tconst ErrorResponsePlaceholder = () => <Placeholder label={'Error'} />;\n\t\n\t/**\n\t * TriggerWhenLoadingFinished Function\n\t * Wrapper function for the server-side render trigger.\n\t * @param {number} countChildren The number of children blocks.\n\t * @returns {Function} The trigger function for server-side rendering.\n\t * @version 1.0.00\n\t */\n\tconst TriggerWhenLoadingFinished = countChildren => {\n\t\treturn () => {\n\t\t\tuseEffect(() => {\n\t\t\t\t// Call action when the loading component unmounts because loading is finished.\n\t\t\t\treturn () => {\n\t\t\t\t\tinsertScriptAssets();\n\t\t\t\t\tinsertCSSAssets();\n\t\t\t\t};\n\t\t\t});\n\t\t\t\n\t\t\treturn (<Placeholder label={'Loading...'} />);\n\t\t};\n\t};\n\t\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={__('Settings', 'pretix-widget')} initialOpen={true}>\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={__('Mode', 'pretix-widget')}\n\t\t\t\t\t\tvalue={mode}\n\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t{ value: 'widget', label: __('Widget', 'pretix-widget') },\n\t\t\t\t\t\t\t{ value: 'button', label: __('Button', 'pretix-widget') },\n\t\t\t\t\t\t]}\n\t\t\t\t\t\tonChange={(value) => handleChange('mode', value)}\n\t\t\t\t\t/>\n\t\t\t\t\t{mode === 'button' && (\n\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\tlabel={__('Button Text', 'pretix-widget')}\n\t\t\t\t\t\t\tvalue={button_text}\n\t\t\t\t\t\t\tonChange={(value) => handleChange('button_text', value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={__('Shop URL', 'pretix-widget')}\n\t\t\t\t\t\tvalue={shop_url}\n\t\t\t\t\t\tonChange={(value) => handleChange('shop_url', value)}\n\t\t\t\t\t\tplaceholder=\"https://pretix.eu/demo\"\n\t\t\t\t\t\ttype=\"url\"\n\t\t\t\t\t/>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={__('Date (Sub-Event)', 'pretix-widget')}\n\t\t\t\t\t\tvalue={subevent}\n\t\t\t\t\t\tonChange={(value) => handleChange('subevent', value)}\n\t\t\t\t\t/>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={__('Products', 'pretix-widget')}\n\t\t\t\t\t\tvalue={items}\n\t\t\t\t\t\tonChange={(value) => handleChange('items', value)}\n\t\t\t\t\t\thelp={mode === 'button' ? __('Use syntax item_ITEMID=2,variation_ITEMID_VARID=4', 'pretix-widget') : __('Enter a comma-separated list of ID numbers.', 'pretix-widget')}\n\t\t\t\t\t/>\n\t\t\t\t\t{mode !== 'button' && (\n\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\tlabel={__('Categories', 'pretix-widget')}\n\t\t\t\t\t\t\tvalue={categories}\n\t\t\t\t\t\t\tonChange={(value) => handleChange('categories', value)}\n\t\t\t\t\t\t\thelp={__('Enter a comma-separated list of ID numbers.', 'pretix-widget')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{mode !== 'button' && (\n\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\tlabel={__('Variations', 'pretix-widget')}\n\t\t\t\t\t\t\tvalue={variations}\n\t\t\t\t\t\t\tonChange={(value) => handleChange('variations', value)}\n\t\t\t\t\t\t\thelp={__('Enter a comma-separated list of ID numbers.', 'pretix-widget')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={__('Pre-selected voucher', 'pretix-widget')}\n\t\t\t\t\t\tvalue={allocated_voucher}\n\t\t\t\t\t\tonChange={(value) => handleChange('allocated_voucher', value)}\n\t\t\t\t\t/>\n\t\t\t\t\t\n\t\t\t\t\t{mode !== 'button' && (\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tlabel={__('List Type', 'pretix-widget')}\n\t\t\t\t\t\t\tvalue={list_type}\n\t\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t\t{ value: 'auto', label: __('Auto', 'pretix-widget') },\n\t\t\t\t\t\t\t\t{ value: 'list', label: __('List', 'pretix-widget') },\n\t\t\t\t\t\t\t\t{ value: 'week', label: __('Calendar Week', 'pretix-widget') },\n\t\t\t\t\t\t\t\t{ value: 'calendar', label: __('Calendar Month', 'pretix-widget') },\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\tonChange={(value) => handleChange('list_type', value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{mode !== 'button' && (\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tlabel={__('Disable voucher input', 'pretix-widget')}\n\t\t\t\t\t\t\tchecked={disable_voucher}\n\t\t\t\t\t\t\tonChange={(value) => handleChange('disable_voucher', value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={__('Language', 'pretix-widget')}\n\t\t\t\t\t\tvalue={language}\n\t\t\t\t\t\toptions={languages.map(({ code, name }) => ({\n\t\t\t\t\t\t\tvalue: code,\n\t\t\t\t\t\t\tlabel: name\n\t\t\t\t\t\t}))}\n\t\t\t\t\t\tonChange={(value) => handleChange('language', value)}\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t\n\t\t\t<div {...blockProps}>\n\t\t\t\t<ServerSideRender\n\t\t\t\t\tblock=\"pretix/widget\"\n\t\t\t\t\tattributes={attributes}\n\t\t\t\t\tLoadingResponsePlaceholder={TriggerWhenLoadingFinished(attributes)}\n\t\t\t\t\tEmptyResponsePlaceholder={EmptyResponsePlaceholder}\n\t\t\t\t\tErrorResponsePlaceholder={ErrorResponsePlaceholder}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n","const { registerBlockType } = wp.blocks;\n\nimport metadata from './block.json';\nimport edit from './edit.js';\nimport save from './save.js';\n\nregisterBlockType('pretix/widget', {\n\t...metadata,\n\tedit,\n\tsave,\n});\n","export default function save(props) {\n\treturn null;\n}"],"names":["_wp$compose","wp","compose","useDebounce","usePrevious","_wp$element","element","RawHTML","useEffect","useRef","useState","_wp$i18n","i18n","__","sprintf","apiFetch","addQueryArgs","url","_wp$components","components","Placeholder","Spinner","__experimentalSanitizeBlockAttributes","blocks","DefaultEmptyResponsePlaceholder","_ref","className","React","createElement","DefaultErrorResponsePlaceholder","_ref2","response","errorMessage","errorMsg","DefaultLoadingResponsePlaceholder","_ref3","children","showLoader","style","position","top","left","marginTop","marginLeft","opacity","ServerSideRender","props","attributes","block","_props$httpMethod","httpMethod","urlQueryArgs","_props$EmptyResponseP","EmptyResponsePlaceholder","_props$ErrorResponseP","ErrorResponsePlaceholder","_props$LoadingRespons","LoadingResponsePlaceholder","isMountedRef","_useState2","_slicedToArray","setShowLoader","fetchRequestRef","_useState4","setResponse","prevProps","_useState6","isLoading","setIsLoading","fetchData","current","sanitizedAttributes","isPostRequest","path","arguments","length","undefined","concat","_objectSpread","context","rendererPath","data","fetchRequest","method","then","fetchResponse","rendered","error","message","debouncedFetchData","JSON","stringify","timeout","setTimeout","clearTimeout","hasResponse","hasEmptyResponse","hasError","_extends","TextControl","ToggleControl","SelectControl","PanelBody","_wp$blockEditor","blockEditor","useBlockProps","InspectorControls","defaults","pretixWidgetDefaults","key","hasOwnProperty","languages","pretixWidgetLanguages","Object","values","registerBlockType","metadata","edit","_defaults$pretix_widg","_defaults$pretix_widg2","_defaults$pretix_widg3","clientId","setAttributes","mode","align","subevent","items","categories","variations","allocated_voucher","_attributes$list_type","list_type","pretix_widget_list_type","_attributes$shop_url","shop_url","pretix_widget_shop_url","replace","_attributes$disable_v","disable_voucher","pretix_widget_disable_voucher","_attributes$language","language","pretix_widget_language","_attributes$button_te","button_text","pretix_widget_button_text","blockProps","handleChange","value","_defineProperty","isValidUrl","URL","err","Fragment","title","initialOpen","label","options","onChange","placeholder","type","help","checked","map","code","name","scriptId","script","document","getElementById","body","removeChild","id","window","PretixWidget","_url","hostname","filename","src","Date","now","async","onload","buildWidgets","appendChild","insertScriptAssets","linkId","link","rel","pathname","href","head","insertCSSAssets","save"],"sourceRoot":""}